package de.pxlab.pxl.spectra;

/**
 * This factory class provides a set of metameric gray reflectance functions.
 * The functions are derived from Wyszecki & Styles (1982) Table III(3.8.2) on
 * page 783. These reflectance functions yield metameric lights with respect to
 * the CIE 1931 standard observer and the CIE standard illuminant C. The XYZ
 * values for these surfaces under illuminant C are: XYZ=(29.41, 30.0, 35.43)
 * and its chromaticities are xy = (0.310,0.316).
 * 
 * <p>
 * Naming rules are such that 'MG1' to 'MG12' may be used to address these
 * spectra.
 * 
 * @author H. Irtel
 * @version 0.1.1
 */
public class MetamericGrayDistribution {
	private static final float[][] mg = {
			{ 0.0575F, 0.1296F, 0.2017F, 0.276350F, 0.3510F, 0.396450F,
					0.4419F, 0.459050F, 0.4762F, 0.468950F, 0.4617F, 0.4407F,
					0.4197F, 0.3863F, 0.3529F, 0.313650F, 0.2744F, 0.218050F,
					0.1617F, 0.1234F, 0.0851F, 0.074250F, 0.0634F, 0.063550F,
					0.0637F, 0.0645F, 0.0653F, 0.065850F, 0.0664F, 0.067050F,
					0.0677F, 0.104050F, 0.1404F, 0.3550F, 0.5696F, 0.6244F,
					0.6792F, 0.6419F, 0.6046F, 0.542850F, 0.4811F, 0.4162F,
					0.3513F, 0.293650F, 0.2360F, 0.189650F, 0.1433F, 0.1121F,
					0.0809F, 0.061550F, 0.0422F, 0.0305F, 0.0188F, 0.0141F,
					0.0094F, 0.006250F, 0.0031F, 0.002350F, 0.0016F, 0.0008F,
					0.0000F, 0.0000F, 0.0000F, 0.002950F, 0.0059F, 0.012350F,
					0.0188F, 0.0235F, 0.0282F, },
			{ 0.0437F, 0.0759F, 0.1081F, 0.142350F, 0.1766F, 0.202250F,
					0.2279F, 0.243450F, 0.2590F, 0.2712F, 0.2834F, 0.2899F,
					0.2964F, 0.2984F, 0.3004F, 0.303850F, 0.3073F, 0.3048F,
					0.3023F, 0.3048F, 0.3073F, 0.3179F, 0.3285F, 0.3410F,
					0.3535F, 0.362150F, 0.3708F, 0.373850F, 0.3769F, 0.371650F,
					0.3664F, 0.3509F, 0.3354F, 0.310250F, 0.2851F, 0.2498F,
					0.2145F, 0.1805F, 0.1465F, 0.117750F, 0.0890F, 0.165750F,
					0.2425F, 0.463950F, 0.6854F, 0.6355F, 0.5856F, 0.4766F,
					0.3676F, 0.291050F, 0.2145F, 0.1661F, 0.1177F, 0.0883F,
					0.0589F, 0.044150F, 0.0294F, 0.0210F, 0.0126F, 0.0084F,
					0.0042F, 0.0021F, 0.0000F, 0.000950F, 0.0019F, 0.0040F,
					0.0061F, 0.007650F, 0.0092F, },
			{ 0.1613F, 0.169150F, 0.1770F, 0.197150F, 0.2173F, 0.2376F,
					0.2579F, 0.2737F, 0.2895F, 0.297950F, 0.3064F, 0.3095F,
					0.3126F, 0.310750F, 0.3089F, 0.3025F, 0.2961F, 0.2778F,
					0.2595F, 0.247250F, 0.2350F, 0.2888F, 0.3426F, 0.387350F,
					0.4321F, 0.439950F, 0.4478F, 0.437350F, 0.4269F, 0.403350F,
					0.3798F, 0.351550F, 0.3233F, 0.2970F, 0.2707F, 0.2491F,
					0.2275F, 0.2130F, 0.1985F, 0.189850F, 0.1812F, 0.1757F,
					0.1702F, 0.167450F, 0.1647F, 0.1676F, 0.1705F, 0.2370F,
					0.3035F, 0.541550F, 0.7796F, 0.7898F, 0.8000F, 0.7246F,
					0.6492F, 0.5738F, 0.4984F, 0.4454F, 0.3924F, 0.352050F,
					0.3117F, 0.290550F, 0.2694F, 0.2612F, 0.2530F, 0.251350F,
					0.2497F, 0.246750F, 0.2438F, },
			{ 0.1148F, 0.1159F, 0.1170F, 0.120650F, 0.1243F, 0.1250F, 0.1257F,
					0.1279F, 0.1301F, 0.131550F, 0.1330F, 0.1336F, 0.1342F,
					0.2167F, 0.2992F, 0.393950F, 0.4887F, 0.482850F, 0.4770F,
					0.4256F, 0.3742F, 0.317450F, 0.2607F, 0.274050F, 0.2874F,
					0.3685F, 0.4496F, 0.4674F, 0.4852F, 0.4494F, 0.4136F,
					0.362950F, 0.3123F, 0.267250F, 0.2222F, 0.1949F, 0.1676F,
					0.1617F, 0.1558F, 0.172550F, 0.1893F, 0.214350F, 0.2394F,
					0.268650F, 0.2979F, 0.324950F, 0.3520F, 0.377050F, 0.4021F,
					0.4211F, 0.4401F, 0.4569F, 0.4737F, 0.4883F, 0.5029F,
					0.5139F, 0.5249F, 0.533650F, 0.5424F, 0.5501F, 0.5578F,
					0.5651F, 0.5724F, 0.5768F, 0.5812F, 0.584850F, 0.5885F,
					0.592150F, 0.5958F, },
			{ 0.0243F, 0.032850F, 0.0414F, 0.0511F, 0.0608F, 0.071350F,
					0.0819F, 0.091650F, 0.1014F, 0.1156F, 0.1298F, 0.143150F,
					0.1565F, 0.221150F, 0.2858F, 0.362350F, 0.4389F, 0.4513F,
					0.4637F, 0.4489F, 0.4341F, 0.4162F, 0.3983F, 0.388950F,
					0.3796F, 0.372250F, 0.3649F, 0.3602F, 0.3555F, 0.3476F,
					0.3397F, 0.324750F, 0.3098F, 0.287050F, 0.2643F, 0.232250F,
					0.2002F, 0.1682F, 0.1362F, 0.1090F, 0.0818F, 0.1776F,
					0.2734F, 0.4906F, 0.7078F, 0.6514F, 0.5950F, 0.4891F,
					0.3832F, 0.3057F, 0.2282F, 0.177050F, 0.1259F, 0.0944F,
					0.0629F, 0.0472F, 0.0315F, 0.0236F, 0.0157F, 0.0118F,
					0.0079F, 0.0059F, 0.0039F, 0.001950F, 0.0000F, 0.0000F,
					0.0000F, 0.0000F, 0.0000F, },
			{ 0.2550F, 0.273450F, 0.2919F, 0.303450F, 0.3150F, 0.3209F,
					0.3268F, 0.3291F, 0.3314F, 0.332050F, 0.3327F, 0.3312F,
					0.3297F, 0.326350F, 0.3230F, 0.317550F, 0.3121F, 0.2999F,
					0.2877F, 0.267750F, 0.2478F, 0.2245F, 0.2012F, 0.1823F,
					0.1634F, 0.1422F, 0.1210F, 0.1082F, 0.0954F, 0.149650F,
					0.2039F, 0.3025F, 0.4011F, 0.379650F, 0.3582F, 0.325550F,
					0.2929F, 0.3374F, 0.3819F, 0.489050F, 0.5962F, 0.551150F,
					0.5061F, 0.4245F, 0.3429F, 0.2747F, 0.2065F, 0.1622F,
					0.1179F, 0.090250F, 0.0626F, 0.045850F, 0.0291F, 0.020950F,
					0.0128F, 0.0101F, 0.0074F, 0.007850F, 0.0083F, 0.0098F,
					0.0113F, 0.0147F, 0.0181F, 0.0202F, 0.0223F, 0.0227F,
					0.0231F, 0.0227F, 0.0223F, },
			{ 0.6061F, 0.6039F, 0.6017F, 0.5760F, 0.5503F, 0.5057F, 0.4611F,
					0.417950F, 0.3748F, 0.3489F, 0.3230F, 0.3108F, 0.2986F,
					0.2938F, 0.2890F, 0.286850F, 0.2847F, 0.2836F, 0.2825F,
					0.282050F, 0.2816F, 0.2814F, 0.2812F, 0.2812F, 0.2812F,
					0.281150F, 0.2811F, 0.282050F, 0.2830F, 0.292950F, 0.3029F,
					0.3182F, 0.3335F, 0.329450F, 0.3254F, 0.3174F, 0.3094F,
					0.303250F, 0.2971F, 0.2933F, 0.2895F, 0.2872F, 0.2849F,
					0.283550F, 0.2822F, 0.2816F, 0.2810F, 0.281250F, 0.2815F,
					0.2865F, 0.2915F, 0.315450F, 0.3394F, 0.3481F, 0.3568F,
					0.3529F, 0.3490F, 0.343750F, 0.3385F, 0.334950F, 0.3314F,
					0.337850F, 0.3443F, 0.369050F, 0.3938F, 0.4247F, 0.4556F,
					0.4809F, 0.5062F, },
			{ 0.2190F, 0.2199F, 0.2208F, 0.2208F, 0.2208F, 0.221650F, 0.2225F,
					0.2234F, 0.2243F, 0.2252F, 0.2261F, 0.227850F, 0.2296F,
					0.2323F, 0.2350F, 0.2509F, 0.2668F, 0.332650F, 0.3985F,
					0.4634F, 0.5283F, 0.513150F, 0.4980F, 0.450150F, 0.4023F,
					0.377550F, 0.3528F, 0.3491F, 0.3454F, 0.331250F, 0.3171F,
					0.3024F, 0.2877F, 0.274850F, 0.2620F, 0.252650F, 0.2433F,
					0.237750F, 0.2322F, 0.228750F, 0.2253F, 0.223750F, 0.2222F,
					0.2214F, 0.2206F, 0.222850F, 0.2251F, 0.270750F, 0.3164F,
					0.478150F, 0.6399F, 0.646850F, 0.6538F, 0.602550F, 0.5513F,
					0.500050F, 0.4488F, 0.4128F, 0.3768F, 0.349150F, 0.3215F,
					0.304850F, 0.2882F, 0.275750F, 0.2633F, 0.2550F, 0.2467F,
					0.241150F, 0.2356F, },
			{ 0.2706F, 0.282550F, 0.2945F, 0.302050F, 0.3096F, 0.3134F,
					0.3172F, 0.3187F, 0.3202F, 0.3206F, 0.3210F, 0.320050F,
					0.3191F, 0.316950F, 0.3148F, 0.311250F, 0.3077F, 0.299750F,
					0.2918F, 0.280150F, 0.2685F, 0.254650F, 0.2408F, 0.228950F,
					0.2171F, 0.201250F, 0.1854F, 0.172350F, 0.1593F, 0.1534F,
					0.1475F, 0.1895F, 0.2315F, 0.322550F, 0.4136F, 0.4641F,
					0.5146F, 0.492850F, 0.4711F, 0.4217F, 0.3723F, 0.3268F,
					0.2813F, 0.2478F, 0.2143F, 0.1935F, 0.1727F, 0.158650F,
					0.1446F, 0.1386F, 0.1326F, 0.152750F, 0.1729F, 0.2980F,
					0.4231F, 0.5227F, 0.6223F, 0.637550F, 0.6528F, 0.634550F,
					0.6163F, 0.594150F, 0.5720F, 0.549250F, 0.5265F, 0.504550F,
					0.4826F, 0.4624F, 0.4422F, },
			{ 0.2411F, 0.278450F, 0.3158F, 0.343050F, 0.3703F, 0.386450F,
					0.4026F, 0.409650F, 0.4167F, 0.413650F, 0.4106F, 0.401050F,
					0.3915F, 0.3718F, 0.3521F, 0.321350F, 0.2906F, 0.241950F,
					0.1933F, 0.144650F, 0.0960F, 0.0727F, 0.0494F, 0.0569F,
					0.0644F, 0.1761F, 0.2878F, 0.4369F, 0.5860F, 0.5806F,
					0.5752F, 0.504650F, 0.4341F, 0.358150F, 0.2822F, 0.2243F,
					0.1664F, 0.1284F, 0.0904F, 0.0688F, 0.0472F, 0.146950F,
					0.2467F, 0.458750F, 0.6708F, 0.618450F, 0.5661F, 0.4667F,
					0.3673F, 0.2924F, 0.2175F, 0.168750F, 0.1200F, 0.0900F,
					0.0600F, 0.0450F, 0.0300F, 0.0225F, 0.0150F, 0.011250F,
					0.0075F, 0.0056F, 0.0037F, 0.001850F, 0.0000F, 0.0000F,
					0.0000F, 0.0000F, 0.0000F, },
			{ 0.3749F, 0.3765F, 0.3781F, 0.377550F, 0.3770F, 0.374250F,
					0.3715F, 0.3685F, 0.3655F, 0.3612F, 0.3569F, 0.3510F,
					0.3451F, 0.3375F, 0.3299F, 0.319250F, 0.3086F, 0.289850F,
					0.2711F, 0.244750F, 0.2184F, 0.1899F, 0.1614F, 0.140550F,
					0.1197F, 0.0967F, 0.0737F, 0.0585F, 0.0433F, 0.0493F,
					0.0553F, 0.123150F, 0.1910F, 0.340250F, 0.4895F, 0.5758F,
					0.6621F, 0.631150F, 0.6002F, 0.5269F, 0.4536F, 0.3856F,
					0.3176F, 0.266850F, 0.2161F, 0.184050F, 0.1520F, 0.1342F,
					0.1164F, 0.1060F, 0.0956F, 0.0934F, 0.0912F, 0.089150F,
					0.0871F, 0.087450F, 0.0878F, 0.091550F, 0.0953F, 0.113150F,
					0.1310F, 0.173250F, 0.2155F, 0.2693F, 0.3231F, 0.355850F,
					0.3886F, 0.4069F, 0.4252F, },
			{ 0.1042F, 0.107150F, 0.1101F, 0.113450F, 0.1168F, 0.1194F,
					0.1220F, 0.125950F, 0.1299F, 0.133150F, 0.1364F, 0.140350F,
					0.1443F, 0.1503F, 0.1563F, 0.191050F, 0.2258F, 0.372850F,
					0.5199F, 0.6660F, 0.8121F, 0.7830F, 0.7539F, 0.6498F,
					0.5457F, 0.4622F, 0.3787F, 0.3293F, 0.2799F, 0.254750F,
					0.2296F, 0.221850F, 0.2141F, 0.209450F, 0.2048F, 0.203850F,
					0.2029F, 0.2097F, 0.2165F, 0.2325F, 0.2485F, 0.2662F,
					0.2839F, 0.302350F, 0.3208F, 0.339750F, 0.3587F, 0.3762F,
					0.3937F, 0.4072F, 0.4207F, 0.4342F, 0.4477F, 0.4592F,
					0.4707F, 0.479750F, 0.4888F, 0.4966F, 0.5044F, 0.5112F,
					0.5180F, 0.5239F, 0.5298F, 0.533950F, 0.5381F, 0.5418F,
					0.5455F, 0.549350F, 0.5532F, }, };

	protected static SpectralDistribution instance(String m) {
		SpectralDistribution s = null;
		int n = id(m) - 1;
		if ((n >= 0) && (n < 12))
			s = new SpectralDistribution(380, 720, 5, (float[]) mg[n].clone());
		return (s);
	}

	private static int id(String n) {
		int t = 0;
		try {
			t = Integer.valueOf(n.substring(2)).intValue();
		} catch (NumberFormatException e) {
			new de.pxlab.pxl.NonFatalError(
					"Invalid metameric gray specification: " + n
							+ "\nReplaced by 'MG1'");
			t = 1;
		}
		return (t);
	}
}
